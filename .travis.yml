language: python

sudo: required

services:
  - docker

before_install:
  - docker build -t trinitronx/ansible-base:stable-centos7 stable-centos7/

script:
  - docker run --rm -t trinitronx/ansible-base:stable-centos7 /bin/sh -c "sudo yum -y install make && mkdir /opt/ansible/ && git clone http://github.com/ansible/ansible.git /opt/ansible/ansible && cd /opt/ansible/ansible && ANSIBLE_VERSION=$(ansible-playbook --version | sed 's/[^0-9.]*\([0-9.]*\).*/\1/') && GIT_TAG=$(git tag | grep $ANSIBLE_VERSION | grep -v rc) && git checkout $GIT_TAG && git submodule update --init && sudo pip install paramiko PyYAML jinja2 httplib2 passlib nose mock && cd test/integration/ && make parsing && make test_var_precedence && make unicode ;"
  - docker ps -a

